for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%V,X2%*%V,n1,n2)
oraclePvalue[i]=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
}
myLevel=sum(myPvalue<0.05)/B
oraclePvalue=sum(oraclePvalue<0.05)/B
}
Out=data.frame(n1=0,n2=0,p=0,r=0,beta=0,level=0)
for(beta in c(0.5,1,2))
for(r in 2)
for(p in c(20,50,100,200,300))
for(n in c(70,140,210)){
n1=n
n2=n
level=simulateLevel(n1,n2,p,r,beta)
temp=data.frame(n1=n1,n2=n2,p=p,r=r,beta=beta,level=level)
Out=rbind(Out,temp)
}
beta
r
p
n
Out
source("./stat.R")
library(ggplot2)
library(xtable)
simulateLevel=function(n1,n2,p,r,beta,B=100,rmax=10){
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%V,X2%*%V,n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oraclePvalue=sum(oraclePvalue<0.05)/B
}
Out=data.frame(n1=0,n2=0,p=0,r=0,beta=0,level=0)
for(beta in c(0.5,1,2))
for(r in 2)
for(p in c(20,50,100,200,300))
for(n in c(70,140,210)){
n1=n
n2=n
level=simulateLevel(n1,n2,p,r,beta)
temp=data.frame(n1=n1,n2=n2,p=p,r=r,beta=beta,level=level)
Out=rbind(Out,temp)
}
Out
beta
r
p
n
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%V,X2%*%V,n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oraclePvalue=sum(oraclePvalue<0.05)/B
B=100
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%V,X2%*%V,n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oraclePvalue=sum(oraclePvalue<0.05)/B
n=210
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%V,X2%*%V,n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oraclePvalue=sum(oraclePvalue<0.05)/B
myLevel
oraclePvalue
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%V,X2%*%V,n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oracleLevel=sum(oraclePvalue<0.05)/B
myLevel
oracleLevel
hist(oraclePvalue)
hist(myPvalue)
beta
p
n
source("./stat.R")
library(ggplot2)
library(xtable)
simulateLevel=function(n1,n2,p,r,beta,B=100,rmax=10){
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%V,X2%*%V,n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
#oracleLevel=sum(oraclePvalue<0.05)/B
}
Out=data.frame(n1=0,n2=0,p=0,r=0,beta=0,level=0)
for(beta in c(0.5,1,2))
for(r in 2)
for(p in c(20,50,100,200,300))
for(n in c(70,140,210)){
n1=n
n2=n
level=simulateLevel(n1,n2,p,r,beta)
temp=data.frame(n1=n1,n2=n2,p=p,r=r,beta=beta,level=level)
Out=rbind(Out,temp)
}
Out
n1=n2=70
n1
n2
p=100
r=2
beta=0.5
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%V,X2%*%V,n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oracleLevel=sum(oraclePvalue<0.05)/B
hist(oraclePvalue)
hist(myPvalue)
svd(var(X1%*%V))
D
D^2
svd((var(X1%*%V)+var(X2%*%V))/2)
jjj=modelSimulator(1000)
svd(var(jjj%*%V))
a=rnorm(100,0,1)
dim(a)=c(50,2)
a
svd(a)
svd(var(a))
eigen(var(a))
a=rnorm(1000,0,1)
dim(a)=c(500,2)
eigen(var(a))
a=rnorm(500,0,1)
dim(a)=c(250,2)
eigen(var(a))
a=rnorm(70,0,1)
a=rnorm(140,0,1)
dim(a)=c(70,2)
eigen(var(a))
a=rnorm(140,0,1)
dim(a)=c(70,2)
eigen(var(a))
eigen(var(X1%*%V))
D^2
a=rnorm(70,0,1)
str(X1)
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%V,X2%*%V,n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
X1
D
n1
n2
p
var(X1%*%V)
D^2
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%V,X2%*%V,n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
X1%*%V
var(X1%*%V)
eigen(var(X1%*%V))
D^2
?solve
V
solve(t(V),0)
?Null
library(MASS)
?Null
Null
Vjj=Null(V)
str(Vjj)
t(V)%*%Vjj
eigen(t(V)%*%Vjj)$values
svd(t(V)%*%Vjj)$d
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%Null(V),X2%*%Null(V),n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oracleLevel=sum(oraclePvalue<0.05)/B
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%Null(V),X2%*%Null(V),n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oracleLevel=sum(oraclePvalue<0.05)/B
hist(oracleLevel)
hist(oraclePvalue)
hist(myPvalue)
source("./stat.R")
library(ggplot2)
library(xtable)
simulateLevel=function(n1,n2,p,r,beta,B=100,rmax=10){
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%Null(V),X2%*%Null(V),n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oracleLevel=sum(oraclePvalue<0.05)/B
list(myLevel=myLevel,oracleLevel=oracleLevel)
}
Out=data.frame(n1=0,n2=0,p=0,r=0,beta=0,myLevel=0,oracleLevel=0)
for(beta in c(0.5,1,2))
for(r in 2)
for(p in c(20,50,100,200,300))
for(n in c(70,140,210)){
n1=n
n2=n
level=simulateLevel(n1,n2,p,r,beta)
temp=data.frame(n1=n1,n2=n2,p=p,r=r,beta=beta,myLevel=level,oracleLevel=oracleLevel)
Out=rbind(Out,temp)
}
Out
temp
source("./stat.R")
library(ggplot2)
library(xtable)
simulateLevel=function(n1,n2,p,r,beta,B=100,rmax=10){
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%Null(V),X2%*%Null(V),n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oracleLevel=sum(oraclePvalue<0.05)/B
list(myLevel=myLevel,oracleLevel=oracleLevel)
}
Out=data.frame(n1=0,n2=0,p=0,r=0,beta=0,myLevel=0,oracleLevel=0)
for(beta in c(0.5,1,2))
for(r in 2)
for(p in c(20,50,100,200,300))
for(n in c(70,140,210)){
n1=n
n2=n
level=simulateLevel(n1,n2,p,r,beta)
temp=data.frame(n1=n1,n2=n2,p=p,r=r,beta=beta,myLevel=level$myLevel,oracleLevel=level$oracleLevel)
Out=rbind(Out,temp)
}
Out
source("./stat.R")
library(ggplot2)
library(xtable)
simulateLevel=function(n1,n2,p,r,beta,B=1000,rmax=10){
temp=modelGenerator(p=p,r=r,beta=beta)
V=temp$V
D=temp$D
modelSimulator=temp$modelSimulator
myPvalue=NULL
oraclePvalue=NULL
for(i in 1:B){
X1=modelSimulator(n1)
X2=modelSimulator(n2)
myPvalue[i]=doTest(X1,X2,n1,n2,p,rmax=10)
# oracle: V known
temp=chenStat(X1%*%Null(V),X2%*%Null(V),n1,n2)
tempOracleStat=n1*n2*temp/(sqrt(2*p)*(n1+n2)*1)
oraclePvalue[i]=pnorm(tempOracleStat,0,1,lower.tail = FALSE)
}
myLevel=sum(myPvalue<0.05)/B
oracleLevel=sum(oraclePvalue<0.05)/B
list(myLevel=myLevel,oracleLevel=oracleLevel)
}
Out=data.frame(n1=0,n2=0,p=0,r=0,beta=0,myLevel=0,oracleLevel=0)
for(beta in c(0.5,1,2))
for(r in 2)
for(p in c(20,50,100,200,300,400))
for(n in c(100,200,300)){
n1=n
n2=n
level=simulateLevel(n1,n2,p,r,beta)
temp=data.frame(n1=n1,n2=n2,p=p,r=r,beta=beta,myLevel=level$myLevel,oracleLevel=level$oracleLevel)
Out=rbind(Out,temp)
}
Out=Out[-1,]
write.csv(Out,"level.csv")
Out
row.names(Out)=NULL
Out
write.csv(Out,"level.csv",row.names = FALSE)
Out=Out[,-2]
Temp1=Out[Out$beta==0.5,]
Temp1=Out[Out$beta==0.5,]
Temp2=Out[Out$beta==1,]
Temp1=Out[Out$beta==2,]
Temp1
?merge
merge(Temp1,Temp2,by=c("n1","p","r"))
Temp1
Temp2
Temp3
Temp1=Out[Out$beta==0.5,]
Temp2=Out[Out$beta==1,]
Temp3=Out[Out$beta==2,]
merge(Temp1,Temp2,by=c("n1","p","r"))
TTT2=merge(TTT1,Temp3,by=c"n1","p","r")
TTT2=merge(TTT1,Temp3,by=c("n1","p","r"))
TTT1=merge(Temp1,Temp2,by=c("n1","p","r"))
TTT2=merge(TTT1,Temp3,by=c("n1","p","r"))
TTT2
TTT2=TTT2[,-c(3,4,7,10)]
TTT2
names(TTT2)=c("n","p","myLevelbeta0.5","oracleLevelbeta0.5","myLevelbeta1","oracleLevelbeta1","myLevelbeta2","oracleLevelbeta2")
myTable1=xtable(TTT2,digits=c(0,0,3,3,3,3,3,3),caption="Test level simulation",label="biaoge1")
myTable1=xtable(TTT2,digits=c(0,0,0,3,3,3,3,3,3),caption="Test level simulation",label="biaoge1")
align(myTable1) <- "rrrrrrrr"
myTable1=xtable(TTT2,digits=c(0,0,0,3,3,3,3,3,3),caption="Test level simulation",label="biaoge1")
align(myTable1) <- "rrrrrrrrr"
print(myTable1,file="level.tex",include.rownames=FALSE)
TTT2
?sort
order(TTT2[,1],TTT2[,2])
TTT2[order(TTT2[,1],TTT2[,2]),]
TTT2=TTT2[order(TTT2[,1],TTT2[,2]),]
myTable1=xtable(TTT2,digits=c(0,0,0,3,3,3,3,3,3),caption="Test level simulation",label="biaoge1")
align(myTable1) <- "rrrrrrrrr"
print(myTable1,file="level.tex",include.rownames=FALSE)
TTT2=TTT2[order(TTT2[,1],TTT2[,2]),]
TTT2
library(readr)
library(plyr)
myFileName=dir("stock data")
data=list()
for(i in myFileName){
temp=read_csv(paste0("stock data/",i))
data=c(data,list(temp[,c(2,6)]))
}
date=NULL
for(i in data){
date=union(date,i[,1])
}
date=as.Date(date)
date=sort(date)
date=data.frame(date=date)
myList=llply(data,function(x){
merge(date,x,all.x=TRUE)$close
})
temp=unlist(myList)
library(readr)
library(plyr)
myFileName=dir("stock data")
data=list()
for(i in myFileName){
temp=read_csv(paste0("stock data/",i))
data=c(data,list(temp[,c(2,6)]))
}
data
library(readr)
library(plyr)
myFileName=dir("stock data")
data=list()
for(i in myFileName){
temp=read_csv(paste0("stock data/",i))
data=c(data,list(temp[,c(2,6)]))
}
myFileName
myFileName=dir("stock data")
dir
dir()
